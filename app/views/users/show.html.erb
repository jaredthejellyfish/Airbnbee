<div class="profile-container">
  <h1>Hi, <%= "#{@user.first_name} #{@user.last_name}"%>!</h1>

    <% if @user.photo.attached? %>
      <%= cl_image_tag @user.photo.key, class:"insect-img"%>
    <% else %>
      <%= image_tag asset_path("blank-prof.jpg"), class:"insect-img"%>
    <% end %>

      <p>First name</p>
      <p><%= @user.first_name %></p>
      <p>Last name</p>
      <p><%= @user.last_name %></p>

      <p>E-mail</p>
      <p><%= @user.email %></p>

    <% if current_user == @user %>
      <button><%= link_to "Edit my profile", edit_user_path(@user) %></button>
      <button><%= link_to "List a new insect", new_insect_path %></button>
    <% end %>

<h3 id="your-insects-header" class="results-header">My insects</h3>

<!-- List of the user's insects -->
<div id="your-insects-container" class="results-container hidden">
    <% Insect.where(user: @user).each do |insect| %>
     <div class="bug-card" data-search-target="card">
        <div class="item-text">
          <h3><%= link_to insect.name, insect_path(insect) %></h3>
        </div>
        <%= insect.description %>
        <% if insect.photo.attached?  %>
          <%= cl_image_tag insect.photo.key, class:"item-image" %>
        <% else %>
          <a href="insects/"><img class="item-image" src="<%= insect.img_url %>"></a>
        <% end %>
    </div>
    <% end %>
  </div>
</div>

<!-- List of the user's bookings -->
<h3 id="your-bookings-header" class="results-header">My bookings</h3>
<div id="your-bookings-container" class="results-container hidden">
  <% @user.bookings.each do |booking| %>
     <div class="booking-card">
     <p><%= cl_image_tag booking.user.photo.key, gravity: :face, class: "client-picture"%> <strong><%= booking.user.first_name %> <%=booking.user.last_name.first%>.</strong></p>
      <p><%= cl_image_tag booking.insect.photo.key, gravity: :auto, class: "insect-picture"%> <strong><%= booking.insect.name %></strong></p>
        <p>Booked from <%= booking.start_date.strftime("%d/%m/%Y") %> to <%= booking.end_date.strftime("%d/%m/%Y") %></p>
        <p><strong><%= booking.insect.price.round %> â‚¬</strong></p>
        <p><%= link_to "Edit", edit_booking_path(booking) %><br><%= link_to "Delete",
            [@user, booking],
            data: {turbo_method: :delete, turbo_confirm: "Are you sure?"}
          %></p>
      </div>
  <% end %>
</div>

<script>
  const insectDropdown = document.getElementById("your-insects-header");
  const bookingDropdown = document.getElementById("your-bookings-header");

  const yourInsects = document.getElementById("your-insects-container");
  const yourBookings = document.getElementById("your-bookings-container");


  insectDropdown.addEventListener("click", (event) => {
    event.preventDefault()
    yourInsects.classList.toggle("hidden");
    yourInsects.classList.toggle("visible");
  })

  bookingDropdown.addEventListener("click", (event) => {
    event.preventDefault()
    yourBookings.classList.toggle("hidden");
    yourBookings.classList.toggle("visible");
  })


</script>
